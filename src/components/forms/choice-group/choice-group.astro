---
const {
  type = "checkbox",
  name,
  options = [],
  title,
  orientation = "vertical",
  required = false,
  class: className,
  ...rest
} = Astro.props;

const htmlAttributes = Object.fromEntries(
  Object.entries(rest).filter(([key]) => !key.startsWith("_"))
);

const groupId = htmlAttributes.id || `choice-group-${crypto.randomUUID()}`;
---

<fieldset
  class:list={["choice-group", `orientation-${orientation}`, className]}
  {...htmlAttributes}
>
  {
    title && (
      <legend class="legend">
        {title}
        {required && (
          <span class="required" aria-label="required">
            *
          </span>
        )}
      </legend>
    )
  }
  <div class="options">
    {
      options.map((option, index) => (
        <label class="option">
          <input
            type={type}
            name={name}
            value={option.value}
            checked={option.checked || false}
            required={required && index === 0}
            aria-required={required && index === 0}
            class="field"
          />
          <span class="label-text">{option.label}</span>
        </label>
      ))
    }
  </div>
</fieldset>
