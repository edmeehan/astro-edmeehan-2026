---
import clsx from "clsx";
import Icon from "../Icon/icon.astro";
import { buttonSchema } from "./schema";

const props = buttonSchema.parse(Astro.props);

const Tag = props.link ? "a" : "button";

const classNames = clsx(
  "button",
  `text-${props.size}`,
  `type-${props.type}`,
  props.layout === "skinny" && "skinny",
  props.outline && "outline",
  props.icon?.display === "icon_only" && "icon-only",
  props.disabled && "disabled",
  props.className
);

import "./theme.pcss";

const actions = props.link
  ? { href: props.link, role: "button" }
  : { type: "button", disabled: props.disabled };
---

<style>
  @import "./styles.pcss";
</style>

<Tag
  {...actions}
  class:list={classNames}
  style={props.customStyle}
  id={props.id}
  aria-label={props.aria?.label}
  aria-describedby={props.aria?.describedBy}
  aria-controls={props.aria?.controls}
  aria-expanded={props.aria?.expanded}
>
  {
    props.icon?.name && props.icon?.position === "before" && (
      <Icon name={props.icon.name} buttonIcon size="none" />
    )
  }

  {
    props.label && (
      <span class:list={props.icon?.display === "icon_only" ? "sr-only" : "label"}>
        {props.label}
      </span>
    )
  }

  {
    props.icon?.name && props.icon?.position === "after" && (
      <Icon name={props.icon.name} buttonIcon size="none" />
    )
  }
</Tag>
